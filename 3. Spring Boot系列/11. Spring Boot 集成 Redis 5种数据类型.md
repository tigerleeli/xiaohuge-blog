## Redis çš„ä»‹ç»

Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒè¢«å¹¿æ³›åœ°åº”ç”¨äºç¼“å­˜ã€è®¡æ•°å™¨ã€é™é€Ÿå™¨ã€æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼é”ç­‰å¤šç§åœºæ™¯ä¸­ã€‚Redis æ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€æ•£åˆ—ã€åˆ—è¡¨ã€é›†åˆå’Œæœ‰åºé›†åˆç­‰ï¼Œå¹¶ä¸”å…·æœ‰é«˜æ€§èƒ½ã€é«˜å¯ç”¨æ€§ã€æŒä¹…åŒ–ä»¥åŠä¸°å¯Œçš„ç‰¹æ€§ï¼Œåœ¨ä¼ä¸šçº§åº”ç”¨ä¸­é€æ¸æˆä¸ºå…³é”®çš„ä¸€ç¯ã€‚

## Redis çš„åº”ç”¨åœºæ™¯

Redis åœ¨ä¼ä¸šåº”ç”¨ä¸­çš„åº”ç”¨åœºæ™¯ååˆ†å¹¿æ³›ï¼š

- ç¼“å­˜ï¼šRedis å¯ä»¥ä½œä¸ºä¸€ç§é«˜é€Ÿç¼“å­˜ï¼Œå°†ä¸€äº›ç»å¸¸è®¿é—®ä½†ä¸ç»å¸¸å˜åŒ–çš„æ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼ŒåŠ å¿«æ•°æ®è¯»å–é€Ÿåº¦ã€‚
- è®¡æ•°å™¨ï¼šRedis å¯ä»¥å¤„ç†è®¡æ•°å™¨åŠŸèƒ½ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç°æœ‰åºé›†åˆçš„æ’åã€ç²‰ä¸é‡ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚
- é™é€Ÿå™¨ï¼šåˆ©ç”¨ Redis çš„è®¡æ•°å™¨åŠŸèƒ½ï¼Œå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œé™é€Ÿï¼Œé¿å…è¿‡å¤šçš„è¯·æ±‚é€ æˆç³»ç»Ÿå´©æºƒã€‚
- åˆ†å¸ƒå¼é”ï¼šé€šè¿‡ Redis çš„åŸå­æ“ä½œå’ŒæŒä¹…åŒ–ç‰¹æ€§ï¼Œå¯ä»¥å®ç°åˆ†å¸ƒå¼é”ï¼Œé¿å…å¤šä¸ªè¿›ç¨‹åŒæ—¶ä¿®æ”¹åŒä¸€æ•°æ®å¸¦æ¥çš„é—®é¢˜ã€‚
- æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis æä¾›äº† Pub/Sub æœºåˆ¶ï¼Œå¯ä»¥å®ç°åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œä¾‹å¦‚ä¸ªæ¨ã€é‡‘èäº¤æ˜“ç­‰ã€‚
- æ•°æ®åº“ï¼šRedis å¯ä»¥ä½œä¸ºæ•°æ®åº“ä½¿ç”¨ï¼Œå…·æœ‰å¿«é€Ÿå“åº”ã€æŒä¹…åŒ–æ•°æ®ç­‰ç‰¹ç‚¹ã€‚
- è´Ÿè½½å‡è¡¡ï¼šåˆ©ç”¨ Redis çš„ Cluster ç‰¹æ€§ï¼Œå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œé¿å…æœåŠ¡å™¨å‡ºç°è¿‡å¿«æˆ–è¿‡æ…¢çš„ç°è±¡ã€‚

## Redis çš„æ•°æ®ç±»å‹

Redis æ”¯æŒçš„æ•°æ®ç±»å‹å…·æœ‰ä¸°å¯Œçš„ç‰¹æ€§å’Œä¸¥æ ¼çš„é™åˆ¶ï¼Œå¯ä»¥æ»¡è¶³å„ç§ä¸åŒæ•°æ®åœºæ™¯çš„éœ€æ±‚ã€‚

- Stringï¼šå­—ç¬¦ä¸²ç±»å‹æ˜¯ Redis æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ã€‚
- Listï¼šåˆ—è¡¨ç±»å‹æ˜¯ä¸€ç§æœ‰åºçš„å…ƒç´ é›†åˆï¼Œæ”¯æŒä»å¤´éƒ¨æˆ–å°¾éƒ¨æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œæ”¯æŒè·å–æŸä¸ªå…ƒç´ çš„å€¼ã€‚
- Hashï¼šæ•£åˆ—ç±»å‹æ˜¯ Redis ä¸­ç”¨æ¥è¡¨ç¤ºå¯¹è±¡çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªé”®å€¼å¯¹å­˜å‚¨ä¸€ä¸ªå­å¯¹è±¡ï¼Œé€‚åˆå­˜å‚¨è¾ƒä¸ºå¤æ‚çš„æ•°æ®ç»“æ„ã€‚
- Setï¼šé›†åˆç±»å‹æ˜¯ Redis ä¸­æä¾›äº†æ— åºå…ƒç´ çš„é›†åˆï¼Œä¸€ä¸ªé”®å€¼å¯¹å¯ä»¥åŒ…å«å¤šä¸ªå…ƒç´ ä¸”å…ƒç´ ä¸èƒ½é‡å¤ï¼Œé€‚åˆå­˜å‚¨æ— åºç›¸å…³å…ƒç´ çš„æ•°æ®ç»“æ„ã€‚
- Sorted Setï¼šæœ‰åºé›†åˆç±»å‹æ˜¯ Redis ä¸­æä¾›äº†å…·æœ‰æ’åºåŠŸèƒ½çš„é›†åˆç±»å‹ï¼Œä¸€ä¸ªé”®å€¼å¯¹å¯ä»¥åŒ…å«å¤šä¸ªå…ƒç´ ä¸”å…ƒç´ ä¸èƒ½é‡å¤ï¼Œé€‚åˆå­˜å‚¨æœ‰å…³è”å±æ€§æˆ–æœ‰åºç›¸å…³å…ƒç´ çš„æ•°æ®ç»“æ„ã€‚

## SpringBoot æ•´åˆ Redis

ä¸‹é¢æˆ‘ä»¬ç»“åˆä¸€ä¸ªç®€å•çš„é¡¹ç›®ï¼Œé€šè¿‡ StringRedisTemplate æ¥æ¼”ç¤ºå„ä¸ªæ•°æ®ç±»å‹çš„ä¾‹å­ã€‚

åœ¨ pom.xml æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹ä¾èµ–ï¼š

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>
```

åœ¨ application.properties æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹è®¾ç½®ï¼š

```
# Redis æ•°æ®åº“
spring.redis.database=0
# Redis æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£å·
spring.redis.host=localhost
spring.redis.port=6379
# Redis è®¿é—®å¯†ç ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å¯†ç å¯ä¸å¡«
spring.redis.password=
```

åœ¨ src/main/java/com/example/demo ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª RedisController ç±»ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹æ³¨è§£ï¼š

```
@RestController
public class RedisController {
    ...
}
```

### å­˜å‚¨ String ç±»å‹æ•°æ®

åœ¨ RedisController ç±»ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–æ³¨å…¥ï¼š

```
@Autowired
private StringRedisTemplate stringRedisTemplate;
```

åœ¨ RedisController ä¸­æ·»åŠ ä¸€ä¸ªç®€å•çš„ String ç±»å‹æ¥å£ï¼Œç”¨äºå­˜å‚¨å’Œè·å–å­—ç¬¦ä¸²ç±»å‹æ•°æ®ï¼š

```
@GetMapping("/redis/setString")
public String setString() {
    String key = "name";
    String value = "Redis";
    stringRedisTemplate.opsForValue().set(key, value);
    return "set success";
}

@GetMapping("/redis/getString")
public String getString() {
    String key = "name";
    String value = stringRedisTemplate.opsForValue().get(key);
    return "get valueï¼š" + value;
}
```

### å­˜å‚¨ List ç±»å‹æ•°æ®

åœ¨ RedisController ç±»ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–æ³¨å…¥ï¼š

```
@Autowired
private RedisTemplate<String, Object> redisTemplate;
```

åœ¨ RedisController ä¸­æ·»åŠ ä¸€ä¸ª List ç±»å‹çš„æ¥å£ï¼Œç”¨äºå­˜å‚¨å’Œè·å– List ç±»å‹æ•°æ®ï¼š

```
@GetMapping("/redis/setList")
public String setList() {
    String key = "list";
    List<String> values = Arrays.asList("Redis", "Java", "Python");
    redisTemplate.opsForList().rightPushAll(key, values);
    return "set success";
}

@GetMapping("/redis/getList")
public List<String> getList() {
    String key = "list";
    List<String> values = redisTemplate.opsForList().range(key, 0, -1);
    return values;
}
```

### å­˜å‚¨ Hash ç±»å‹æ•°æ®

åœ¨ RedisController ç±»ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–æ³¨å…¥ï¼š

```
@Autowired
private StringRedisTemplate stringRedisTemplate;
```

åœ¨ RedisController ä¸­æ·»åŠ ä¸€ä¸ª Hash ç±»å‹çš„æ¥å£ï¼Œç”¨äºå­˜å‚¨å’Œè·å– Hash ç±»å‹æ•°æ®ï¼š

```
@GetMapping("/redis/setHash")
public String setHash() {
    String key = "user";
    stringRedisTemplate.opsForHash().put(key, "name", "Redis");
    stringRedisTemplate.opsForHash().put(key, "age", "18");
    return "set success";
}

@GetMapping("/redis/getHash")
public Map<String, String> getHash() {
    String key = "user";
    Map<String, String> result = stringRedisTemplate.opsForHash().entries(key);
    return result;
}
```

### å­˜å‚¨ Set ç±»å‹æ•°æ®

åœ¨ RedisController ç±»ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–æ³¨å…¥ï¼š

```
@Autowired
private StringRedisTemplate stringRedisTemplate;
```

åœ¨ RedisController ä¸­æ·»åŠ ä¸€ä¸ª Set ç±»å‹çš„æ¥å£ï¼Œç”¨äºå­˜å‚¨å’Œè·å– Set ç±»å‹æ•°æ®ï¼š

```
@GetMapping("/redis/setSet")
public String setSet() {
    String key = "set";
    stringRedisTemplate.opsForSet().add(key, "Redis", "Java", "Python");
    return "set success";
}

@GetMapping("/redis/getSet")
public Set<String> getSet() {
    String key = "set";
    Set<String> result = stringRedisTemplate.opsForSet().members(key);
    return result;
}
```

### å­˜å‚¨ Sorted Set ç±»å‹æ•°æ®

åœ¨ RedisController ç±»ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–æ³¨å…¥ï¼š

```
@Autowired
private StringRedisTemplate stringRedisTemplate;
```

åœ¨ RedisController ä¸­æ·»åŠ ä¸€ä¸ª Sorted Set ç±»å‹çš„æ¥å£ï¼Œç”¨äºå­˜å‚¨å’Œè·å– Sorted Set ç±»å‹æ•°æ®ï¼š

```
@GetMapping("/redis/setSortedSet")
public String setSortedSet() {
    String key = "sortedSet";
    Set<ZSetOperations.TypedTuple<String>> values = new HashSet<>();
    values.add(new DefaultTypedTuple<>("Redis", 1D));
    values.add(new DefaultTypedTuple<>("Java", 2D));
    values.add(new DefaultTypedTuple<>("Python", 3D));
    stringRedisTemplate.opsForZSet().add(key, values);
    return "set success";
}

@GetMapping("/redis/getSortedSet")
public Set<String> getSortedSet() {
    String key = "sortedSet";
    Set<String> result = stringRedisTemplate.opsForZSet().range(key, 0, -1);
    return result;
}
```

è¿è¡Œ SpringBoot é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ä»¥ä¸Šæ¥å£ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„æ•°æ®ç±»å‹å­˜å‚¨å’Œè·å–æ•ˆæœã€‚

## æ€»ç»“

Redis æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå…·æœ‰é«˜å¯ç”¨æ€§ã€é«˜æ€§èƒ½ã€æŒä¹…åŒ–å’Œæ”¯æŒå¤šç§æ•°æ®ç»“æ„ç­‰ç‰¹ç‚¹ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚åŒæ—¶ï¼Œä½¿ç”¨ SpringBoot ä¹Ÿå¯ä»¥å¿«é€Ÿåœ°å®ç° Redis çš„ä½¿ç”¨ï¼Œå¹¶ä¸” StringRedisTemplate æä¾›äº†ä¸°å¯Œçš„ APIï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ“ä½œ Redis ä¸­çš„æ•°æ®ã€‚å„ä¸ªæ•°æ®ç±»å‹çš„å®ç°éœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯è€Œå®šï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±åœ°é€‰æ‹©æ•°æ®ç»“æ„å’Œä½¿ç”¨æ–¹å¼ã€‚

![](https://files.mdnice.com/user/33663/cbff779f-c976-4135-9b93-ba208a5b0624.png)

å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼šâ€œå°è™å“¥çš„æŠ€æœ¯åšå®¢â€ã€‚æˆ‘ä»¬ä¼šå®šæœŸå‘å¸ƒå…³äºJavaæŠ€æœ¯çš„è¯¦å°½æ–‡ç« ï¼Œè®©æ‚¨èƒ½å¤Ÿæ·±å…¥äº†è§£è¯¥é¢†åŸŸçš„å„ç§æŠ€å·§å’Œæ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æˆä¸ºæ›´ä¼˜ç§€çš„ç¨‹åºå‘˜ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ï¼

ç›¸å…³æ–‡ç« æºç æ”¾åœ¨ï¼š[giteeä»“åº“](https://gitee.com/cunzaizhe/xiaohuge-blog)ã€[githubä»“åº“](https://github.com/tigerleeli/xiaohuge-blog)ä¸Šã€‚