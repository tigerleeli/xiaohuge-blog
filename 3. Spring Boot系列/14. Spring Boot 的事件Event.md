ä»¥åˆ›å»ºè®¢å•å¹¶å‘å¸ƒè®¢å•äº‹ä»¶ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªâ€œä¸‹å•â€æ“ä½œï¼Œæ¯å½“ç”¨æˆ·ä¸‹å•æ—¶ï¼Œç³»ç»Ÿéœ€è¦åˆ›å»ºè®¢å•å¹¶å°†è¯¥è®¢å•ä¿¡æ¯å‘å¸ƒå‡ºå»ï¼Œä»¥ä¾¿å…¶ä»–æ¨¡å—ï¼ˆæ¯”å¦‚å‘é€é‚®ä»¶ã€æ‰“å°ã€çŸ­ä¿¡ç­‰ï¼‰èƒ½åšç›¸åº”çš„å¤„ç†ã€‚

äº‹ä»¶æœºåˆ¶é€šè¿‡ äº‹ä»¶å‘å¸ƒã€ç›‘å¬ å’Œ å¤„ç† æ¥å®ç°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸‹å•æ“ä½œå®Œæˆåï¼Œå‘å¸ƒä¸€ä¸ªè®¢å•äº‹ä»¶ï¼Œè®©å…¶ä»–æ¨¡å—å¯ä»¥ç›‘å¬åˆ°è¯¥äº‹ä»¶å¹¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè®¢å•å®ä½“ç±»ï¼Œå…¶ä¸­åŒ…æ‹¬è®¢å•ç¼–å·ã€ä¹°å®¶IDã€è®¢å•é‡‘é¢ç­‰ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹å•æ“ä½œå®Œæˆåï¼Œå°†è¿™ä¸ªè®¢å•å®ä½“ç±»ä¼ é€’ç»™ä¸€ä¸ªè®¢å•æœåŠ¡ã€‚è®¢å•æœåŠ¡å°†ä¼šå®Œæˆä»¥ä¸‹ä¸¤ä¸ªæ“ä½œï¼š

- å‘å¸ƒè®¢å•äº‹ä»¶ - è®¢å•äº‹ä»¶å°†åŒ…æ‹¬è®¢å•å®ä½“ç±»çš„ä¿¡æ¯ï¼Œå‘å¸ƒäº‹ä»¶åï¼Œå…¶ä»–æ¨¡å—å°±å¯ä»¥ç›‘å¬è¯¥äº‹ä»¶å¹¶åšå‡ºç›¸åº”çš„å¤„ç†ï¼ˆæ¯”å¦‚ç»™ä¹°å®¶å‘é‚®ä»¶ã€æ›´æ–°è®¢å•çŠ¶æ€ç­‰ï¼‰ã€‚

- å­˜å‚¨è®¢å•åˆ°æ•°æ®åº“ - å°†è®¢å•ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä»¥ä¾¿åç»­æŸ¥è¯¢å’Œä½¿ç”¨ã€‚

é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼š
```
â”œâ”€â”€ config
â”‚   â””â”€â”€ AppConfig.java
â”œâ”€â”€ entity
â”‚   â””â”€â”€ Order.java
â”œâ”€â”€ event
â”‚   â”œâ”€â”€ OrderEvent.java
â”‚   â”œâ”€â”€ OrderEventListener.java
â”‚   â””â”€â”€ OrderEventPublisher.java
â”œâ”€â”€ repository
â”‚   â””â”€â”€ OrderRepository.java
â”œâ”€â”€ service
â”‚   â””â”€â”€ OrderService.java
â””â”€â”€ SpringBootDemoApplicatio
```
### 1. å®ä½“ç±» Order

```java
@Entity
public class Order {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(name = "order_no")
    private String orderNo;

    @Column(name = "buyer_id")
    private Long buyerId;

    @Column(name = "total_amount")
    private BigDecimal totalAmount;

    // getter and setter
}
```

### 2. è®¢å• Repository

ä½¿ç”¨ Spring Data JPA æä¾›çš„ Repository æ¥æ“ä½œæ•°æ®åº“ã€‚

```java
@Repository
public interface OrderRepository extends JpaRepository<Order, Long> {
}
```

### 3. è®¢å•ç›¸å…³æœåŠ¡

æœåŠ¡åŒ…æ‹¬ï¼šåˆ›å»ºè®¢å•ã€å‘å¸ƒè®¢å•äº‹ä»¶ã€å­˜å‚¨è®¢å•åˆ°æ•°æ®åº“ã€‚

```java
@Service
public class OrderService {
    @Autowired
    private OrderEventPublisher publisher;

    @Autowired
    private OrderRepository repository;

    @Transactional
    public void createOrder(Order order) {
        // 1. å‘å¸ƒè®¢å•äº‹ä»¶
        publisher.publishEvent(order);

        // 2. å­˜å‚¨è®¢å•åˆ°æ•°æ®åº“
        repository.save(order);
    }
}
```

### 4. è®¢å•åˆ›å»ºäº‹ä»¶

```java
public class OrderEvent extends ApplicationEvent {
    private Order order;

    public OrderEvent(Object source, Order order) {
        super(source);
        this.order = order;
    }

    public Order getOrder() {
        return order;
    }
}
```

### 5. è®¢å•äº‹ä»¶ç›‘å¬å™¨

```java
public class OrderEventListener implements ApplicationListener<OrderEvent> {
    @Override
    public void onApplicationEvent(OrderEvent event) {
        Order order = event.getOrder();
        System.out.println("è®¢å•äº‹ä»¶ç›‘å¬å™¨ï¼š" + order);
        // do something
    }
}
```

### 6. è®¢å•äº‹ä»¶å‘å¸ƒå™¨

```java
@Service
public class OrderEventPublisher implements ApplicationEventPublisherAware {
    private ApplicationEventPublisher publisher;

    @Override
    public void setApplicationEventPublisher(ApplicationEventPublisher publisher) {
        this.publisher = publisher;
    }

    public void publishEvent(Order order) {
        OrderEvent event = new OrderEvent(this, order);
        this.publisher.publishEvent(event);
    }
}
```

### 7. å¯åŠ¨ç±»

```java
@SpringBootApplication
public class SpringBootDemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootDemoApplication.class, args);
    }

    @Autowired
    private OrderService orderService;

    @Bean
    public OrderEventListener orderEventListener() {
        return new OrderEventListener();
    }

    @Bean
    public ApplicationRunner applicationRunner(OrderRepository repository) {
        return args -> {
            // æ¨¡æ‹Ÿåˆ›å»ºè®¢å•
            Order order = new Order();
            order.setOrderNo(UUID.randomUUID().toString());
            order.setBuyerId(1L);
            order.setTotalAmount(new BigDecimal("199.99"));

            // åˆ›å»ºè®¢å•
            orderService.createOrder(order);
        };
    }
}
```

### 8. æ€»ç»“
äº‹ä»¶æœºåˆ¶æ˜¯ä¸€ç§å®ç°æ¨¡å—ä¹‹é—´è§£è€¦åˆçš„æ–¹æ¡ˆã€‚åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸åŒçš„æ¨¡å—ä¹‹é—´éœ€è¦å®Œæˆæ•°æ®äº¤äº’å’Œæµç¨‹è°ƒåº¦ã€‚åŒæ—¶ï¼Œä¸šåŠ¡åœºæ™¯ä¸æ•°æ®çš„å˜åŒ–ä¹Ÿä¼šå½±å“åˆ°åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚æ­¤æ—¶ï¼Œå®ç°æ¨¡å—ä¹‹é—´çš„è§£è€¦åˆä¾¿éå¸¸æœ‰å¿…è¦ã€‚äº‹ä»¶æœºåˆ¶å°±æ˜¯ä¸€ç§èƒ½å¤Ÿå“åº”ä¸šåŠ¡åœºæ™¯å’Œæ•°æ®å˜åŒ–çš„æ–¹æ¡ˆï¼Œå½“æŸäº›æ“ä½œå‘ç”Ÿæ—¶ï¼Œäº‹ä»¶æœºåˆ¶é€šçŸ¥åº”ç”¨ç¨‹åºä¸­çš„å…¶ä»–éƒ¨åˆ†ã€‚äº‹ä»¶æœºåˆ¶çš„è®¾è®¡å¯ä»¥åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥æ›´å®¹æ˜“åœ°æ‰©å±•æ–°çš„åŠŸèƒ½ã€‚

![](https://files.mdnice.com/user/33663/cbff779f-c976-4135-9b93-ba208a5b0624.png)

å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼šâ€œå°è™å“¥çš„æŠ€æœ¯åšå®¢â€ã€‚æˆ‘ä»¬ä¼šå®šæœŸå‘å¸ƒå…³äºJavaæŠ€æœ¯çš„è¯¦å°½æ–‡ç« ï¼Œè®©æ‚¨èƒ½å¤Ÿæ·±å…¥äº†è§£è¯¥é¢†åŸŸçš„å„ç§æŠ€å·§å’Œæ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æˆä¸ºæ›´ä¼˜ç§€çš„ç¨‹åºå‘˜ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ï¼

ç›¸å…³æ–‡ç« æºç æ”¾åœ¨ï¼š[giteeä»“åº“](https://gitee.com/cunzaizhe/xiaohuge-blog)ã€[githubä»“åº“](https://github.com/tigerleeli/xiaohuge-blog)ä¸Šã€‚