**ä»£ç†ï¼ˆProxyï¼‰æ¨¡å¼å…è®¸å°†å¯¹è±¡çš„æ“ä½œè½¬ç§»ç»™å…¶ä»–å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸æ”¹å˜å…¶ç»“æ„çš„æƒ…å†µä¸‹å¢å¼ºå…¶åŠŸèƒ½æˆ–è€…æ§åˆ¶å…¶è®¿é—®ã€‚**

## ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼

ä»£ç†æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ§åˆ¶è®¿é—®å’Œå¢å¼ºå¯¹è±¡åŠŸèƒ½çš„è®¾è®¡æ¨¡å¼ã€‚ä»£ç†æ¨¡å¼ä¸­ï¼Œä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡éƒ½å®ç°äº†ç›¸åŒçš„æ¥å£ï¼Œå¹¶ä¸”ä»£ç†å¯¹è±¡åœ¨å…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªçœŸå®å¯¹è±¡çš„å¼•ç”¨ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚ä»£ç†å¯¹è±¡æ—¶ï¼Œä»£ç†å¯¹è±¡å°†å…¶è½¬å‘ç»™çœŸå®å¯¹è±¡ï¼Œå¹¶åœ¨è°ƒç”¨å‰æˆ–è°ƒç”¨åè¿›è¡Œä¸€äº›å¢å¼ºæ“ä½œã€‚

ä»£ç†æ¨¡å¼æœ‰ä¸åŒçš„ç±»å‹ï¼Œä¾‹å¦‚é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ã€‚é™æ€ä»£ç†æ˜¯åœ¨ç¼–è¯‘æ—¶åˆ›å»ºçš„ä»£ç†å¯¹è±¡ï¼Œè€ŒåŠ¨æ€ä»£ç†æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ä»£ç†å¯¹è±¡ã€‚å› æ­¤ï¼ŒåŠ¨æ€ä»£ç†æ›´åŠ çµæ´»å’Œæ˜“äºæ‰©å±•ã€‚

åœ¨ Java ä¸­ï¼Œä»£ç†æ¨¡å¼æ˜¯å¹¿æ³›ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå¯ä»¥ç”¨äºå®ç° AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ç­‰åº”ç”¨åœºæ™¯ã€‚

## ä»£ç†æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯

- å½“ç›®æ ‡å¯¹è±¡ä¸é€‚åˆç›´æ¥è®¿é—®æˆ–è€…ä¸æ–¹ä¾¿è®¿é—®æ—¶ã€‚
- å½“éœ€è¦åœ¨å¯¹è±¡çš„è®¿é—®ä¸Šå¢åŠ æ§åˆ¶å’Œå®‰å…¨æ€§æ—¶ã€‚
- å½“éœ€è¦å¢å¼ºå¯¹è±¡çš„åŠŸèƒ½æ—¶ã€‚
- å½“å¯¹è±¡çš„è®¿é—®éœ€è¦ç»™äºˆå…¶ä»–å¯¹è±¡æˆ–æ¯ä¸ªå¯¹è±¡ä¸å¯èƒ½è®°ä½æ‰€æœ‰ç»†èŠ‚æ—¶ã€‚

## é™æ€ä»£ç†çš„ä»£ç ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨é™æ€ä»£ç†æ–¹å¼çš„ä»£ç ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª `Subject` æ¥å£å’Œä¸€ä¸ª `RealSubject` ç±»ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ª `StaticProxy` ä»£ç†ç±»å¯¹å…¶è¿›è¡Œå¢å¼ºå¤„ç†ï¼š

```java
// Subject æ¥å£
public interface Subject {
    void request();
}

// RealSubject æ¥å£
public class RealSubject implements Subject {
    public void request() {
        System.out.println("è®¿é—®çœŸå®å¯¹è±¡");
    }
}

// StaticProxy ä»£ç†ç±»
public class StaticProxy implements Subject {
    private Subject subject;
    
    // æ„é€ å‡½æ•°åˆå§‹åŒ–ç›®æ ‡å¯¹è±¡
    public StaticProxy(Subject subject) {
        this.subject = subject;
    }

    public void request() {
        System.out.println("è°ƒç”¨æ–¹æ³•å‰å¢å¼º");
        subject.request();
        System.out.println("è°ƒç”¨æ–¹æ³•åå¢å¼º");
    }
}

// å®¢æˆ·ç«¯ä½¿ç”¨ç¤ºä¾‹
public class Client {
    public static void main(String[] args) {
        // åˆ›å»ºç›®æ ‡å¯¹è±¡
        RealSubject realSubject = new RealSubject();
        // åˆ›å»ºä»£ç†å¯¹è±¡å¹¶åˆå§‹åŒ–ç›®æ ‡å¯¹è±¡
        StaticProxy proxy = new StaticProxy(realSubject);
        // é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•
        proxy.request();
    }
}
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ`StaticProxy` ç±»å®ç°äº† `Subject` æ¥å£ï¼Œå¹¶åœ¨å…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª `RealSubject` å¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨ `request()` æ–¹æ³•ä¸­ï¼Œä»£ç†å¯¹è±¡å…ˆè¿›è¡Œå¢å¼ºå¤„ç†ï¼Œç„¶åè°ƒç”¨ç›®æ ‡å¯¹è±¡çš„ `request()` æ–¹æ³•ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œåå†è¿›è¡Œå¢å¼ºå¤„ç†ã€‚

åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œé¦–å…ˆåˆ›å»ºäº†ç›®æ ‡å¯¹è±¡ `RealSubject`ï¼Œç„¶ååˆ›å»ºä»£ç†å¯¹è±¡ `StaticProxy` å¹¶å°†å…¶ç»‘å®šåˆ°ç›®æ ‡å¯¹è±¡ä¸Šï¼Œæœ€åé€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•ã€‚

æ€»çš„æ¥è¯´ï¼Œé™æ€ä»£ç†æ˜¯ä¸€ç§ç®€å•æ˜“ç”¨çš„ä»£ç†æ¨¡å¼ï¼Œé€‚åˆäºä¸€äº›å°è§„æ¨¡çš„åº”ç”¨åœºæ™¯ï¼Œä½†å¯¹äºå¤§è§„æ¨¡çš„ç³»ç»Ÿæ¥è¯´ï¼Œä»£ç†ç±»çš„æ•°é‡ä¼šéå¸¸å¤šï¼Œå¢åŠ ä»£ç ç»´æŠ¤çš„éš¾åº¦å’Œå¤æ‚åº¦ã€‚æ­¤æ—¶æ›´åŠ çµæ´»ã€å¯æ‰©å±•å’Œæ˜“äºç»´æŠ¤çš„æ–¹å¼æ˜¯åŠ¨æ€ä»£ç†ã€‚

## åŠ¨æ€ä»£ç†çš„ç¤ºä¾‹ä»£ç 

#### Java JDKåŠ¨æ€ä»£ç†
JDK åŠ¨æ€ä»£ç†ä¸»è¦æ¶‰åŠä¸¤ä¸ªç±»ï¼šProxy å’Œ InvocationHandlerã€‚

JDK åŠ¨æ€ä»£ç†æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œå®ç°åŠ¨æ€ä»£ç†ä¸»è¦æ˜¯é€šè¿‡ Proxy ç±»å®Œæˆï¼Œè¯¥ç±»æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³• newProxyInstance()ï¼Œç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡ã€‚è¯¥æ–¹æ³•éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š

1. ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ï¼šç”¨äºåŠ è½½ä»£ç†ç±»ã€‚
2. ä»£ç†ç±»éœ€è¦å®ç°çš„æ‰€æœ‰æ¥å£ï¼ˆClass<?>[] interfacesï¼‰ï¼šä»£ç†å¯¹è±¡éœ€è¦å®ç°çš„æ‰€æœ‰æ¥å£ã€‚
3. å¤„ç†å™¨å¯¹è±¡ï¼ˆInvocationHandlerï¼‰ï¼šè¯¥ä»£ç†å¯¹è±¡çš„å…·ä½“æ‰§è¡Œé€»è¾‘ã€‚

```java
Object proxy = Proxy.newProxyInstance(classLoader, interfaces, invocationHandler);
```

InvocationHandler æ¥å£æ˜¯ Java JDK åŠ¨æ€ä»£ç†çš„æ ¸å¿ƒæ¥å£ã€‚è¯¥æ¥å£åªæœ‰ä¸€ä¸ªæ–¹æ³• invoke()ï¼Œç”¨äºå¤„ç†ä»£ç†å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚è¯¥æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š

1. ä»£ç†å¯¹è±¡ï¼ˆObjectï¼‰ï¼šè¢«ä»£ç†çš„å¯¹è±¡å®ä¾‹ã€‚
2. å½“å‰è°ƒç”¨çš„æ–¹æ³•ï¼ˆMethodï¼‰ï¼šè¢«è°ƒç”¨çš„æ–¹æ³•å®ä¾‹ã€‚
3. æ–¹æ³•çš„å‚æ•°ï¼ˆObject[]ï¼‰ï¼šæ–¹æ³•çš„å‚æ•°å¯¹è±¡ã€‚

```java
public interface InvocationHandler {
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable;
}
```

åœ¨ invoke() æ–¹æ³•ä¸­ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¯¹åŸæ–¹æ³•è¿›è¡Œå¢å¼ºã€ä¿®æ”¹æˆ–ç»•è¿‡ç­‰æ“ä½œï¼Œå¹¶è¿”å›ä»£ç†å¯¹è±¡çš„æ‰§è¡Œç»“æœã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ JDK åŠ¨æ€ä»£ç†ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Hello æ¥å£å’Œå®ç°ç±» HelloImplï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è°ƒç”¨ Hello æ¥å£çš„ sayHello() æ–¹æ³•å‰ååˆ†åˆ«è¾“å‡ºâ€œHello, Beforeâ€å’Œâ€œHello, Afterâ€ã€‚

```java
// Hello æ¥å£
public interface Hello {
    void sayHello();
}

// Hello å®ç°ç±»
public class HelloImpl implements Hello {
    @Override
    public void sayHello() {
        System.out.println("Hello, World!");
    }
}

// ä»£ç†å¤„ç†å™¨
public class HelloProxy implements InvocationHandler {
    private Object target;

    public HelloProxy(Object target) {
        this.target = target;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println("Hello, Before");
        Object result = method.invoke(target, args);
        System.out.println("Hello, After");
        return result;
    }
}

// æµ‹è¯•ä»£ç 
public class ProxyTest {
    public static void main(String[] args) {
        // åˆ›å»ºç›®æ ‡å¯¹è±¡
        Hello hello = new HelloImpl();

        // åˆ›å»ºä»£ç†å¯¹è±¡
        HelloProxy helloProxy = new HelloProxy(hello);
        Hello helloProxyInstance = (Hello) Proxy.newProxyInstance(hello.getClass().getClassLoader(),
                                                            hello.getClass().getInterfaces(),
                                                            helloProxy);

        // è°ƒç”¨ä»£ç†å¯¹è±¡æ–¹æ³•
        helloProxyInstance.sayHello();
    }
}
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```
Hello, Before
Hello, World!
Hello, After
```

ä»è¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ¨è°ƒç”¨ä»£ç†å¯¹è±¡çš„ sayHello() æ–¹æ³•å‰ååˆ†åˆ«æ‰§è¡Œäº†â€œHello, Beforeâ€å’Œâ€œHello, Afterâ€çš„è¾“å‡ºã€‚è¿™å°±æ˜¯ JDK åŠ¨æ€ä»£ç†çš„åŸºæœ¬å®ç°åŸç†ã€‚

#### CGLIB åŠ¨æ€ä»£ç†
ä½¿ç”¨ CGLIB åŠ¨æ€ä»£ç†ä¸»è¦ç”¨åˆ°ä¸¤ä¸ªç±»ï¼šEnhancer å’Œ MethodInterceptorã€‚

ä½¿ç”¨ Enhancer ç±»å¯ä»¥å®ç°åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶è®¾ç½®ä»£ç†å¯¹è±¡çš„çˆ¶ç±»ã€å¢å¼ºå™¨ç­‰ã€‚ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š

```java
Enhancer enhancer = new Enhancer();   // åˆ›å»º Enhancer å¯¹è±¡
enhancer.setSuperclass(TargetObject.class);   // è®¾ç½®çˆ¶ç±»
enhancer.setCallback(new TargetInterceptor());   // è®¾ç½®å¢å¼ºå™¨
TargetObject targetObjectProxy = (TargetObject) enhancer.create();   // åˆ›å»ºä»£ç†å¯¹è±¡
```

éœ€è¦è®¾ç½®ä»£ç†å¯¹è±¡çš„çˆ¶ç±»ã€å¢å¼ºå™¨ Callbackã€æ¥å£ç­‰å±æ€§ã€‚

MethodInterceptor æ¥å£æ˜¯ CGLIB åŠ¨æ€ä»£ç†çš„æ ¸å¿ƒæ¥å£ï¼Œå¿…é¡»å®ç°è¯¥æ¥å£çš„ intercept() æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šåœ¨ä»£ç†å¯¹è±¡æ–¹æ³•è°ƒç”¨æ—¶è¢«è°ƒç”¨ã€‚å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š

1. ä»£ç†å¯¹è±¡ï¼ˆObjectï¼‰ï¼šè¡¨ç¤ºè¢«ä»£ç†çš„å¯¹è±¡ã€‚
2. åŸå§‹æ–¹æ³•ï¼ˆMethodï¼‰ï¼šè¡¨ç¤ºè¢«ä»£ç†å¯¹è±¡è¢«æ‹¦æˆªçš„æ–¹æ³•ã€‚
3. æ–¹æ³•å‚æ•°åˆ—è¡¨ï¼ˆObject[]ï¼‰ï¼šè¡¨ç¤ºè¢«ä»£ç†å¯¹è±¡è¢«æ‹¦æˆªçš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ã€‚
4. MethodProxyï¼šè¡¨ç¤ºå¯¹è¢«ä»£ç†å¯¹è±¡æ–¹æ³•çš„ä»£ç†ï¼ŒinvokeSuper() æ–¹æ³•å¯ä»¥è°ƒç”¨å®é™…çš„ç›®æ ‡å¯¹è±¡ã€‚

```java
public interface MethodInterceptor {
    public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable;
}
```

åœ¨ intercept() æ–¹æ³•ä¸­ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¯¹åŸæ–¹æ³•è¿›è¡Œå¢å¼ºã€ä¿®æ”¹æˆ–ç»•è¿‡ç­‰æ“ä½œï¼Œå¹¶è¿”å›ä»£ç†å¯¹è±¡çš„æ‰§è¡Œç»“æœã€‚


ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ CGLIB åŠ¨æ€ä»£ç†ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª UserService æ¥å£å’Œå®ç°ç±» UserServiceImplï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è°ƒç”¨ UserService æ¥å£çš„æ–¹æ³•å‰ååˆ†åˆ«è¾“å‡ºâ€œBeforeâ€å’Œâ€œAfterâ€ã€‚

```java
// UserService æ¥å£
public interface UserService {
    public void addUser();
}

// UserService å®ç°ç±»
public class UserServiceImpl implements UserService {
    public void addUser() {
        System.out.println("Add a user");
    }
}

// CGLIB åŠ¨æ€ä»£ç†æ‹¦æˆªå™¨
public class UserServiceInterceptor implements MethodInterceptor {
    public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
        System.out.println("Before");
        Object result = proxy.invokeSuper(obj, args);
        System.out.println("After");
        return result;
    }
}

// æµ‹è¯•ä»£ç 
public class ProxyTest {
    public static void main(String[] args) {
        // åˆ›å»ºç›®æ ‡å¯¹è±¡
        UserService userService = new UserServiceImpl();

        // åˆ›å»ºå¢å¼ºå™¨
        Enhancer enhancer = new Enhancer();
        enhancer.setSuperclass(userService.getClass());
        enhancer.setCallback(new UserServiceInterceptor());

        // åˆ›å»ºä»£ç†å¯¹è±¡
        UserService userServiceProxy = (UserService) enhancer.create();

        // è°ƒç”¨ä»£ç†å¯¹è±¡æ–¹æ³•
        userServiceProxy.addUser();
    }
}
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```
Before
Add a user
After
```

ä»è¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ¨è°ƒç”¨ä»£ç†å¯¹è±¡çš„ addUser() æ–¹æ³•å‰ååˆ†åˆ«æ‰§è¡Œäº†â€œBeforeâ€å’Œâ€œAfterâ€çš„è¾“å‡ºã€‚è¿™å°±æ˜¯ CGLIB åŠ¨æ€ä»£ç†çš„åŸºæœ¬å®ç°åŸç†ã€‚

## ä»£ç†æ¨¡å¼çš„å®é™…åº”ç”¨

1. Spring AOP

Spring AOP ä½¿ç”¨ä»£ç†æ¨¡å¼æ¥å®ç°é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ï¼Œå…¶ä¸­ï¼Œä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•æ—¶è´Ÿè´£æ·»åŠ æ¨ªåˆ‡é€»è¾‘ï¼Œå¹¶æœ€ç»ˆå°†è°ƒç”¨è½¬å‘ç»™ç›®æ ‡å¯¹è±¡ã€‚Spring AOP æä¾›äº†ä¸¤ç§ä»£ç†æ–¹å¼ï¼šJDK åŠ¨æ€ä»£ç†å’Œ CGLIB ä»£ç†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†è‡³å°‘ä¸€ä¸ªæ¥å£ï¼Œåˆ™ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚å¦åˆ™ï¼Œä¼šä½¿ç”¨ CGLIB ä»£ç†ã€‚

ä»¥ä¸‹æ˜¯é€šè¿‡ Spring AOP é…ç½®å¢å¼ºæ–¹æ³•çš„ç¤ºä¾‹ï¼š

```java
@Aspect
@Component
public class LoggingAspect {

    @Before("execution(* com.example.demo.service.UserService.*(..))")
    public void logBefore(JoinPoint joinPoint) {
        System.out.println("è°ƒç”¨æ–¹æ³•å‰å¢å¼º");
    }

    @After("execution(* com.example.demo.service.UserService.*(..))")
    public void logAfter(JoinPoint joinPoint) {
        System.out.println("è°ƒç”¨æ–¹æ³•åå¢å¼º");
    }
}
```

2. Hibernate

Hibernate æ˜¯ä¸€ä¸ªæµè¡Œçš„ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒä½¿ç”¨ä»£ç†æ¨¡å¼æ¥å»¶è¿ŸåŠ è½½å¯¹è±¡ã€‚å»¶è¿ŸåŠ è½½æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œåœ¨å¯¹è±¡è¢«è¯·æ±‚æ—¶ä»æ•°æ®åº“ä¸­åŠ è½½ã€‚
ä»¥ä¸‹æ˜¯é€šè¿‡ Hibernate å®ç°æ‡’åŠ è½½çš„ç¤ºä¾‹ï¼š

```java
@Entity
public class Customer {
    @Id
    private int id;
    private String name;
    // ...
    @OneToMany(mappedBy = "customer", fetch = FetchType.LAZY)
    private Set<Order> orders = new HashSet<>();
    // ...
}

@Entity
public class Order {
    @Id
    private int id;
    private Date orderDate;
    // ...
    @ManyToOne(fetch = FetchType.LAZY)
    private Customer customer;
    // ...
}
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œé€šè¿‡ `@OneToMany` å’Œ `@ManyToOne` æ³¨é‡Šé…ç½®äº†åŒå‘å…³è”ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ç§å…³è”ä¼šè‡ªåŠ¨è¿›è¡Œæ‡’åŠ è½½ï¼Œå³åœ¨è®¿é—®è®¢å•åˆ—è¡¨æˆ–å®¢æˆ·è¯¦æƒ…æ—¶æ‰ä¼šä»æ•°æ®åº“ä¸­åŠ è½½ã€‚

3. MyBatis

MyBatis æ˜¯ä¸€ä¸ªæµè¡Œçš„ SQL æ˜ å°„æ¡†æ¶ï¼Œå®ƒä½¿ç”¨äº†ä»£ç†æ¨¡å¼æ¥å»¶è¿ŸåŠ è½½å¯¹è±¡ã€‚å’Œ Hibernate ç±»ä¼¼ï¼ŒMyBatis ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ¥å®ç°å»¶è¿ŸåŠ è½½ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ MyBatis å’Œä»£ç†æ¨¡å¼çš„ç¤ºä¾‹ï¼š

```java
// UserMapper.java
public interface UserMapper {
    @Select("SELECT * FROM user WHERE id = #{id}")
    @Results({
        @Result(property = "id", column = "id"),
        @Result(property = "name", column = "name"),
        @Result(property = "orders", column = "id", 
            javaType = List.class, many = @Many(select = "com.example.demo.dao.OrderMapper.findByUserId"))
    })
    User findById(int id);
}

// OrderMapper.java
public interface OrderMapper {
    @Select("SELECT * FROM order WHERE user_id = #{userId}")
    List<Order> findByUserId(int userId);
}

// User.java
public class User {
    private int id;
    private String name;
    private List<Order> orders;
    // getters and setters
}

// Order.java
public class Order {
    private int id;
    private Date date;
    // getters and setters
}
```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé€šè¿‡é…ç½® MyBatis çš„ `@Result` æ³¨é‡Šå’Œ `@Many` æ³¨é‡Šæ¥å®ç°å»¶è¿ŸåŠ è½½ã€‚å½“ä¸€ä¸ªç”¨æˆ·å¯¹è±¡è°ƒç”¨ `getOrders()` æ–¹æ³•æ—¶ï¼Œä»£ç†å¯¹è±¡ä¼šä»æ•°æ®åº“ä¸­æŸ¥è¯¢è¯¥ç”¨æˆ·çš„æ‰€æœ‰è®¢å•å¹¶è¿”å›ã€‚

å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼šâ€œå°è™å“¥çš„æŠ€æœ¯åšå®¢â€ã€‚æˆ‘ä»¬ä¼šå®šæœŸå‘å¸ƒå…³äºJavaæŠ€æœ¯çš„è¯¦å°½æ–‡ç« ï¼Œè®©æ‚¨èƒ½å¤Ÿæ·±å…¥äº†è§£è¯¥é¢†åŸŸçš„å„ç§æŠ€å·§å’Œæ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æˆä¸ºæ›´ä¼˜ç§€çš„ç¨‹åºå‘˜ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ï¼
