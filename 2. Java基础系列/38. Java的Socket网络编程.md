Java ç½‘ç»œç¼–ç¨‹æ˜¯å®ç°ç½‘ç»œé€šä¿¡çš„é‡è¦æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°åƒèŠå¤©å®¤ã€è¿œç¨‹è°ƒç”¨ã€ä¸‹è½½ã€ä¸Šä¼ ç­‰ç½‘ç»œåº”ç”¨ã€‚Java ç½‘ç»œç¼–ç¨‹æ˜¯åŸºäº TCP/IP åè®®å®ç°çš„ï¼Œåœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Socket ç±»æ¥è¿›è¡Œåˆ›å»ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„é€šä¿¡ã€‚Socket ç±»æ˜¯åœ¨ java.net åŒ…ä¸­å®ç°çš„ã€‚

## TCP/IP ç½‘ç»œåè®®

TCP/IP æ˜¯ Transmission Control Protocol / Internet Protocolï¼Œæ˜¯ä¸€ç»„ç½‘ç»œé€šä¿¡åè®®ï¼Œæ˜¯å› ç‰¹ç½‘çš„åŸºç¡€ã€‚TCP/IP åè®®æ—ä¸»è¦åŒ…æ‹¬å…¥é—¨çº§åè®®ï¼ˆå¦‚ IPã€ICMPï¼‰ã€ä¼ è¾“å±‚åè®®ï¼ˆå¦‚ TCP ä¸ UDPï¼‰å’Œåº”ç”¨å±‚åè®®ï¼ˆå¦‚ FTPã€HTTPã€SMTP ç­‰ï¼‰

- IPï¼ˆInternet Protocolï¼‰åè®®ï¼šç”¨äºå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„å’Œè½¬å‘ï¼ŒIP æŠŠæ•°æ®åˆ†æˆæ•°æ®åŒ…è¿›è¡Œä¼ è¾“ï¼Œæ¯ä¸ªæ•°æ®åŒ…åŒ…å«å‘é€åœ°å€ã€æ¥æ”¶åœ°å€å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚
- ICMPï¼ˆInternet Control Message Protocolï¼‰åè®®ï¼šç”¨äºå¯¹ç½‘ç»œé€šä¿¡çŠ¶æ€è¿›è¡Œç›‘æ§å’Œè°ƒæ•´ï¼Œå¸¸ç”¨äº ping å‘½ä»¤ã€‚
- TCPï¼ˆTransmission Control Protocolï¼‰åè®®ï¼šæ˜¯ä¸€ç§å¯é çš„ã€é¢å‘è¿æ¥çš„é€šä¿¡åè®®ï¼Œè´Ÿè´£æä¾›é«˜å¯é æ€§çš„æ•°æ®ä¼ è¾“ã€‚TCP åè®®ä»¥å­—èŠ‚æµæ–¹å¼ä¼ è¾“æ•°æ®ï¼Œä¼šå…ˆå»ºç«‹è¿æ¥å†è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œæ‰€ä»¥å¯é æ€§æ›´é«˜ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ã€ç”µå­é‚®ä»¶ç­‰ä¼ è¾“è¾ƒå¤§æ•°é‡çš„æ•°æ®ã€‚
- UDPï¼ˆUser Datagram Protocolï¼‰åè®®ï¼šæ˜¯ä¸€ç§æ— è¿æ¥ã€ä¸å¯é çš„é€šä¿¡åè®®ï¼Œä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œä¸ä¿è¯æ•°æ®æ˜¯å¦åˆ°è¾¾ï¼Œç”¨äºå®ç°è§†é¢‘ã€éŸ³é¢‘ç­‰å®æ—¶ä¼ è¾“çš„æœåŠ¡ï¼Œé€Ÿåº¦æ›´å¿«ã€‚

## ServerSocket

ServerSocket æ˜¯æœåŠ¡ç«¯çš„å¥—æ¥å­—å¯¹è±¡ï¼Œæä¾›äº†ç”¨äºç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚å¹¶æ¥å—è¿æ¥è¯·æ±‚çš„æ–¹æ³•ï¼Œåœ¨ TCP/IP è¿æ¥ä¸­æœåŠ¡ç«¯ä¸€èˆ¬é€šè¿‡ ServerSocket å»ç›‘å¬å®¢æˆ·ç«¯çš„ Socket è¿æ¥ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

- `void bind(SocketAddress endpoint, int backlog)`ï¼šå°† ServerSocket ç»‘å®šåˆ°æŒ‡å®šçš„ç«¯å£å’Œ IP åœ°å€ï¼Œå¹¶è®¾ç½®ç­‰å¾…é˜Ÿåˆ—çš„é•¿åº¦ï¼ˆä¸€èˆ¬ä¸º 50ï¼‰ã€‚
- `Socket accept()`ï¼šç›‘å¬å¹¶ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œè¿”å›ä¸€ä¸ª Socket å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨äºä¸å®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ã€‚
- `void close()`ï¼šå…³é—­ ServerSocket çš„è¿æ¥ã€‚

å…¶ä¸­ï¼ŒSocketAddress ç±»ç”¨äºè¡¨ç¤º IP åœ°å€å’Œç«¯å£å·ã€‚

```java
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {
    public static void main(String[] args) {
        System.out.println("Server start.");

        try {
            // åˆ›å»º ServerSocket å¯¹è±¡ï¼Œå¹¶ç›‘å¬æŒ‡å®šçš„ç«¯å£
            ServerSocket serverSocket = new ServerSocket(8888);
            System.out.println("Server started, listening on port " + serverSocket.getLocalPort());
            // å¾ªç¯ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚
            while (true) {
                // é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚
                Socket socket = serverSocket.accept();
                // å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚
                new ServerThread(socket).start();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

## Socket

Socket æ˜¯å®¢æˆ·ç«¯çš„å¥—æ¥å­—å¯¹è±¡ï¼Œç”¨äºä¸æœåŠ¡ç«¯è¿›è¡Œè¿æ¥ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

- `void connect(SocketAddress endpoint)`ï¼šè¿æ¥åˆ°æŒ‡å®š IP åœ°å€å’Œç«¯å£å·çš„è¿œç¨‹ä¸»æœºã€‚
- `InputStream getInputStream()`ï¼šè·å–è¯¥ Socket è¿æ¥çš„è¾“å…¥æµï¼Œå¯ä»¥ä»è¾“å…¥æµè¯»å–è¿œç¨‹ä¸»æœºå‘é€çš„æ•°æ®ã€‚
- `OutputStream getOutputStream()`ï¼šè·å–è¯¥ Socket è¿æ¥çš„è¾“å‡ºæµï¼Œå¯ä»¥å‘è¾“å‡ºæµå†™å…¥æ•°æ®ã€‚
- `void close()`ï¼šå…³é—­ Socket çš„è¿æ¥ã€‚

```java
import java.io.*;
import java.net.Socket;

public class Client {
    public static void main(String[] args) {
        System.out.println("Client start.");

        try {
            // å»ºç«‹ Socket è¿æ¥ï¼Œè¿æ¥åˆ°æœåŠ¡ç«¯
            Socket socket = new Socket("localhost", 8888);
            // è·å– Socket å¯¹åº”çš„è¾“å…¥æµå’Œè¾“å‡ºæµ
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())));

            // å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯
            out.println("Hello, World!");
            out.flush();
            // æ¥æ”¶æœåŠ¡ç«¯çš„æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†
            String response = in.readLine();
            System.out.println("Received from server: " + response);

            // å…³é—­æµå’Œ Socket è¿æ¥
            in.close();
            out.close();
            socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

## åŸºäºå¤šçº¿ç¨‹çš„ Socket é€šä¿¡

åœ¨å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼æ¥å¤„ç†ã€‚å½“æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ä¹‹åï¼Œå°±å¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯æ¯ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½èƒ½å¤Ÿå¾—åˆ°ç›¸åº”çš„å¤„ç†ï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡å…¶ä»–å®¢æˆ·ç«¯çš„è¿æ¥å’Œå¤„ç†ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š

```java
import java.io.*;
import java.net.Socket;

public class ServerThread extends Thread {
    private Socket socket;

    public ServerThread(Socket socket) {
        this.socket = socket;
    }

    @Override
    public void run() {
        System.out.println("Client connected: " + socket.getRemoteSocketAddress());
        try {
            // è·å– Socket å¯¹åº”çš„è¾“å…¥æµå’Œè¾“å‡ºæµ
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())));

            // å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚
            String request = in.readLine();
            System.out.println("Received from client: " + request);
            out.println("Your message has been received. response success.");
            out.flush();

            // å…³é—­æµå’Œ Socket è¿æ¥
            in.close();
            socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

## Java ç½‘ç»œç¼–ç¨‹åº”ç”¨

Java ç½‘ç»œç¼–ç¨‹åº”ç”¨éå¸¸å¹¿æ³›ï¼Œä¾‹å¦‚å¯ä»¥å®ç°ç½‘ç»œèŠå¤©å®¤ã€æ–‡ä»¶ä¼ è¾“ã€è¿œç¨‹è°ƒç”¨ç­‰ã€‚ç¤ºä¾‹ä»£ç ï¼š

```java
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;

public class NetworkApplication {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºæœåŠ¡ç«¯ï¼Œç›‘å¬å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚
        ServerSocket serverSocket = new ServerSocket(9999);
        System.out.println("Server started, listening on: " + serverSocket.getLocalSocketAddress());
        while (true) {
            // é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥
            Socket socket = serverSocket.accept();
            // å®¢æˆ·ç«¯è¿æ¥æˆåŠŸï¼Œå¯åŠ¨çº¿ç¨‹å¤„ç†è¯·æ±‚
            new HandlerThread(socket).start();
        }
    }

    private static class HandlerThread extends Thread {
        private Socket socket;

        public HandlerThread(Socket socket) {
            this.socket = socket;
        }

        @Override
        public void run() {
            try {
                // è¯»å–å®¢æˆ·ç«¯ä¼ æ¥çš„æ¶ˆæ¯
                BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                StringBuilder message = new StringBuilder();
                String line;
                while ((line = reader.readLine()) != null) {
                    message.append(line);
                }
                System.out.println("Received message from client: " + message);

                // å‘é€å“åº”
                PrintWriter writer = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())));
                writer.println("Hello, Client.");
                writer.flush();

                // å…³é—­æµå’Œ Socket è¿æ¥
                reader.close();
                writer.close();
                socket.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
```

ä¸€ä¸ªç®€å•çš„ Java ç½‘ç»œåº”ç”¨å°±å®ç°äº†ï¼Œç¨‹åºå¯ä»¥ä¸åœåœ°ç›‘å¬å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ï¼Œæ”¶åˆ°è¯·æ±‚ä¹‹åå°±å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œå°±ä¼šå‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯æ¥æ”¶æ¶ˆæ¯ä¹‹åå‘å®¢æˆ·ç«¯å›å¤ä¸€ä¸ªæ¶ˆæ¯ã€‚

## æ€»ç»“

Java ç½‘ç»œç¼–ç¨‹æ˜¯å»ºç«‹åœ¨ TCP/IP åè®®ä¸Šçš„ç½‘ç»œé€šä¿¡æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå®ç°ä¸¤ä¸ªç«¯ç‚¹ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼‰ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚åœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Socket ç±»æ¥å®ç°ç½‘ç»œç¼–ç¨‹ï¼ŒæœåŠ¡ç«¯é€šè¿‡ ServerSocket ç›‘å¬å®¢æˆ·ç«¯è¿æ¥ï¼Œå®¢æˆ·ç«¯é€šè¿‡ Socket è¿æ¥æœåŠ¡ç«¯ã€‚åœ¨å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œéœ€è¦ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ã€‚Java ç½‘ç»œç¼–ç¨‹çš„åº”ç”¨åœºæ™¯å¹¿æ³›ã€‚

![](https://files.mdnice.com/user/33663/cbff779f-c976-4135-9b93-ba208a5b0624.png)

å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼šâ€œå°è™å“¥çš„æŠ€æœ¯åšå®¢â€ã€‚æˆ‘ä»¬ä¼šå®šæœŸå‘å¸ƒå…³äºJavaæŠ€æœ¯çš„è¯¦å°½æ–‡ç« ï¼Œè®©æ‚¨èƒ½å¤Ÿæ·±å…¥äº†è§£è¯¥é¢†åŸŸçš„å„ç§æŠ€å·§å’Œæ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æˆä¸ºæ›´ä¼˜ç§€çš„ç¨‹åºå‘˜ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ï¼

ç›¸å…³æ–‡ç« æºç æ”¾åœ¨ï¼š[giteeä»“åº“](https://gitee.com/cunzaizhe/xiaohuge-blog)ã€[githubä»“åº“](https://github.com/tigerleeli/xiaohuge-blog)ä¸Šã€‚